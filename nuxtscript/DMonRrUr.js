import{I as X,u as Y,m as B,e as o,r as j,U as C}from"./cyCOdGck.js";import{e as L}from"./CAC1Cd_U.js";const W=X("searchStore",()=>{const{SEARCH_MODAL_MAX_LOCAL_HISTORY:A,SEARCH_MODAL_RECENT_LOCAL_KEY:f,SEARCH_MODAL_ONCE_MAX_RESULTS:g,FETCH_TRIAL_CNT:p}=Y().public.CONSTANTS,R=B(),r=o(),u=o(),c=o(),s=o(),t=o(),n=j({list:[],cnt:0}),d=o(0),O=(e,a)=>{r.value=e,u.value=a},E=e=>{c.value=e},N=e=>{s.value=e},w=e=>{t.value=e},I=()=>{m(),r.value&&(r.value=void 0),u.value&&(u.value=void 0),c.value&&(c.value=void 0),s.value&&(s.value=void 0),t.value&&(t.value=void 0)},b=e=>{if(!t.value)return;const a=e.length;return t.value.setSelectionRange(a,a),t.value.focus(),!0},H=()=>{t.value&&t.value.blur()},M=async()=>{const e=h();if(r.value&&(r.value.placeholder=""),u.value&&(u.value.style.display="none"),!s.value)return!1;await s.value.show(),b(e),setTimeout(()=>{const a=h();if(a)if(a==="/"){v("");return}else if(a&&a[a.length-1]=="/"){const l=a.slice(0,-1);v(l)}else v(a)},1)},m=()=>{s.value&&s.value.hide()},$=()=>{r.value&&(r.value.placeholder="",u.value.style.display="none")},y=()=>{r.value&&(r.value.placeholder="종합 검색 (     를 눌러 창 띄우기)"),r.value&&r.value.value===""&&(u.value.style.display="block"),H()},D=()=>{if(t.value)return t.value===document.activeElement},F=e=>{r.value&&(r.value.value=e)},U=e=>{e?(M(),t.value&&(t.value.value=e)):y()},k=async e=>{const a=await L((l,i,S)=>{p>l||console.log("trial, error, errorData: ",l,i,S)},e);return n.list=a,n.cnt=a.length,d.value=0,n},J=async e=>{e=C.trim(e).toLowerCase(),d.value++;const a=await L((_,K,P)=>{p>_||console.log("trial, error, errorData: ",_,K,P)},e),l=d.value*g,i=l+g,S=a.slice(l,i);return n.list=S,n.cnt=a.length,n},q=()=>t.value?t.value.value:"",h=()=>r.value?r.value.value:"",v=e=>{if(r.value&&(r.value.value=e,!!t.value))return t.value.value=e,e},G=e=>{if(c.value&&(c.value.value=e,!!t.value))return t.value.value=e,e},T=e=>{const a=localStorage.getItem(f)??"";if(!a){localStorage.setItem(f,JSON.stringify({history:[e]}));return}const l=JSON.parse(a);l.history.filter(i=>i===e).length||(l.history.length>A&&l.history.shift(),l.history.push(e),localStorage.setItem(f,JSON.stringify(l)))};return{registerSearchTop:O,registerTab:E,registerSearchModal:N,registerSearchModalMirror:w,onBeforeUnmount:I,showSearchModal:M,hideSearchModal:m,seqShow:$,seqHide:y,chckSearchModalInputIsFocused:D,update2SearchTop:F,update2SearchModal:U,updateSearch:k,scrollNextSearch:J,getSearchModal:q,getSearchTop:h,setSearchTop:v,setSearchFooter:G,add2RecentStorage:T,go2FilteredPage:async(e="")=>{let a="";if(e)a=e;else{if(!t.value)return;a=C.trim(t.value.value)}T(a),await R.push({path:`/filter/${a}`})}}});export{W as u};
