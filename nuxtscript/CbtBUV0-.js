import{d as j,e as u,i as q,l as B,m as E,b as I,j as D,u as H,f as K,q as W,o as Y,x as z,y as G,a as e,w as g,v as x,g as i,t as w,n as L,U as C,B as V}from"./cyCOdGck.js";const X={class:"w-1/3 mt-8 max-w-[500px] text-white font-medium rounded-lg text-sm px-5 py-2.5 text-center",onsubmit:"return false"},F={class:"mb-6"},J={class:"mb-6"},Q={class:"mb-6"},Z={for:"password",class:"block mb-2 text-sm font-medium"},ee={class:"mb-6"},te={class:"text-xs mt-1 flex flex-row justify-center items-center font-bold text-green-500"},ae={class:"text-xs mt-1 flex flex-row justify-center items-center font-bold text-red-500"},oe=j({__name:"info",setup(re){const l=u(),r=u(),a=u(),d=u(),p=u(!1),n=u(-1),m=u("text-red-500"),c=u(""),{$client:R}=q(),U=B(),y=E(),f=I(),{show:h,hide:$}=D(),{TOAST_WARNING_TIMEOUT:b,TOAST_ERROR_TIMEOUT:A,AUTH_NAME_MAX_CNT:k,AUTH_PWD_MIN_CNT:v}=H().public.CONSTANTS,_=s=>{if(!r.value)return;r.value.value.length>k?p.value=!0:p.value=!1},T=s=>{if(!a.value)return;const t=a.value.value,o=C.chckPasswordStrength(t);if(a.value.value===""){c.value="";return}o==="strong"&&(m.value="text-green-500",c.value="보안성 높음"),o==="medium"&&(m.value="text-yellow-500",c.value="보안성 중간"),o==="weak"&&(m.value="text-red-500",c.value="보안성 낮음")},N=()=>{if(a.value&&d.value){if(!d.value.value){n.value=-1;return}a.value.value===d.value.value?n.value=1:n.value=0}},S=async()=>{if(!l.value||!r.value||!a.value)return;const s=r.value.value??C.getRndName(),{message:t,isOverlapped:o,isError:O,isSuccess:P}=await R.user.signUp.mutate({email:l.value.value,name:s,pwd:a.value.value,picture:"",phone:""});if(console.log("msg: ",t),o){f.warning("이미 가입되어있는 이메일입니다",{timeout:b});return}if(O){f.warning("알 수 없는 요인으로 인한 전달 오류. 재시도 해주세요",{timeout:b});return}P&&await y.push({path:"/auth/confirmation",query:{email:l.value.value}})},M=async s=>{if(!l.value||!r.value||!a.value||!d.value)return;const t=r.value.value.trim();if(!t)return;if(t.includes(" ")){f.warning("별칭에 띄어쓰기를 빼주세요",{timeout:b});return}if(a.value.value.length<v){f.warning(`비밀번호를 최소 ${v}자리이상으로 만들어야해요`,{timeout:b}),a.value.focus();return}if(n.value===-1){a.value.focus();return}if(n.value===0){f.error("비밀번호 재확인 불일치",{timeout:A}),d.value.focus();return}if(!r.value.value){h({msg:"별칭을 임시로 생성할까요?",btn:"yesno",onYes:async()=>{await S()}});return}await S()};return K(()=>{if(!l.value)return;const s=U.query.email;if(s){l.value.value=s;return}h({msg:"이메일이 없습니다! 이메일 입력 페이지로 다시 돌아갑니다",onHide:()=>{y.push({path:"/auth/email"})}})}),W(()=>{$()}),(s,t)=>{const o=V;return Y(),z(o,{name:"auth",step:"info"},{default:G(()=>[e("form",X,[e("div",F,[t[0]||(t[0]=e("label",{for:"email",class:"block mb-2 text-sm font-medium"},"Your email",-1)),e("input",{ref_key:"$email",ref:l,type:"email",class:"shadow-sm bg-gray-300 border border-gray-300 text-gray-500 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5",disabled:""},null,512)]),e("div",J,[t[1]||(t[1]=e("label",{for:"name",class:"block mb-2 text-sm font-medium"},"별칭",-1)),e("input",{ref_key:"$name",ref:r,type:"name",id:"name",class:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 dark:shadow-sm-light",onChange:_,onKeyup:_},null,544),g(e("div",{class:"text-xs mt-1 flex flex-row justify-center items-center font-bold text-red-500"},w(`별칭은 ${i(k)}글자이하로 해주세요`),513),[[x,i(p)]])]),e("div",Q,[e("label",Z," 비밀번호 생성 (최소 "+w(i(v))+"자리) * ",1),e("input",{ref_key:"$pwd",ref:a,type:"password",class:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 dark:shadow-sm-light",required:"",autocomplete:"on",onChange:T,onKeyup:T},null,544),e("div",{class:L(["text-xs mt-1 flex flex-row justify-center items-center font-bold",i(m)])},w(i(c)),3)]),e("div",ee,[t[2]||(t[2]=e("label",{for:"repeat-password",class:"block mb-2 text-sm font-medium"},"비밀번호 재확인 *",-1)),e("input",{ref_key:"$pwdRepeat",ref:d,type:"password",class:"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500 dark:shadow-sm-light",required:"",autocomplete:"on",onChange:N,onKeyup:N},null,544),g(e("div",te," 일치 ",512),[[x,i(n)===1]]),g(e("div",ae," 불일치 ",512),[[x,i(n)===0]])]),e("button",{type:"submit",class:"mt-8 text-center text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5",onClick:M}," 새 계정 등록 ")])]),_:1})}}});export{oe as default};
