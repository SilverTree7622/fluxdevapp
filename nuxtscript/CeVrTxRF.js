const i={admob:{bannerCache:{},init:async(e=!0)=>{try{return window.admob?(e&&window.admob.configure({testDeviceIds:["33BE2250B43518CCDA7DE426D04EE231"]}),await window.admob.start(),!0):!1}catch(n){return console.error("AdMob 초기화 실패:",n),!1}},getFromJson:(e,n)=>e!=="and"&&e!=="ios"?(console.error("type is not valid: ",e),{}):n.app.admob[e],appOpenAd:(e="")=>{if(!window.admob)return;document.addEventListener("admob.ready",r=>{console.log("evt from admob.ready: ",r)}),document.addEventListener("admob.ad.show",async r=>{r.ad instanceof window.admob.AppOpenAd&&console.log("appOpenAd show")});const n=new window.admob.AppOpenAd({adUnitId:e||"ca-app-pub-3940256099942544/9257395921"});n.on("load",r=>{console.log("appOpenAd load evt: ",r),n.show()}),n.load()},showBanner:async(e="",n)=>{try{if(!window.admob)return{banner:null};const r=e||"ca-app-pub-3940256099942544/6300978111";if(i.admob.bannerCache[r]){console.log("기존 배너 재사용:",r);const o=i.admob.bannerCache[r];try{return o.isShowing||(await o.show(),o.isShowing=!0,window.admob.BannerAd.list.includes(o)||(window.admob.BannerAd.list.push(o),window.parent&&window.parent.admob&&window.parent.admob.BannerAd.list.push(o))),{banner:o}}catch(t){console.error("캐시된 배너 재사용 실패:",t),delete i.admob.bannerCache[r]}}const d={adUnitId:r,position:(n==null?void 0:n.position)??"bottom",size:window.admob.BannerAd[(n==null?void 0:n.size)??"BANNER"]??"BANNER",offset:(n==null?void 0:n.offset)??0};console.log("create new banner:",d);const a=new window.admob.BannerAd(d);a.on("impression",async o=>{console.log("evt from banner impression: ",o)}),a.on("load",async o=>{console.log("evt from banner load: ",o)}),a.on("error",async o=>{console.log("evt from banner error: ",o),delete i.admob.bannerCache[r]});try{await a.show(),a.isShowing=!0,i.admob.bannerCache[r]=a,window.admob.BannerAd.list=window.admob.BannerAd.list||[],window.admob.BannerAd.list.push(a),window.parent&&window.parent.admob&&(window.parent.admob.BannerAd.list=window.parent.admob.BannerAd.list||[],window.parent.admob.BannerAd.list.push(a))}catch(o){return console.error("배너 표시 실패:",o),{banner:null}}return{banner:a}}catch(r){return console.error("배너 광고 표시 실패:",r),{banner:null}}},hideBanner:()=>{if(window.admob)try{window.admob.BannerAd.list=window.admob.BannerAd.list||[],window.admob.BannerAd.list.forEach(e=>{e&&(e.hide(),e.isShowing=!1)}),window.admob.BannerAd.list=[],window.parent&&window.parent.admob&&(window.parent.admob.BannerAd.list=window.parent.admob.BannerAd.list||[],window.parent.admob.BannerAd.list.forEach(e=>{e&&(e.hide(),e.isShowing=!1)}),window.parent.admob.BannerAd.list=[])}catch(e){console.error("배너 숨기기 실패:",e)}},showInterstitial:async e=>{try{if(!window.admob)return!1;const n=new window.admob.InterstitialAd({adUnitId:e});return await n.load(),await n.show(),!0}catch(n){return console.error("전면 광고 표시 실패:",n),!1}},showRewardVideo:async(e,n,r,d)=>{try{if(!window.admob)return!1;const a=new window.admob.RewardedAd({adUnitId:e});return a.on("load",async o=>{console.log("evt from rewarded load v2: ",o),console.log("window['AndroidFullScreen']: ",window.AndroidFullScreen),setTimeout(()=>{console.log("hide navigation bar")},3e3)}),a.on("reward",async o=>{console.log("evt from rewarded reward: ",o),n&&n(),i.admob.reward.isRewarded=!0}),a.on("dismiss",async o=>{console.log("evt from rewarded dismiss: ",o),r&&r(i.admob.reward.isRewarded),i.admob.reward.reset()}),a.on("error",async o=>{console.log("evt from rewarded error: ",o),d&&d()}),await a.load(),await a.show(),!0}catch(a){return console.error("리워드 광고 표시 실패:",a),!1}},reward:{isPending:!1,isRewarded:!1,reset:()=>{i.admob.reward.isPending=!1,i.admob.reward.isRewarded=!1},showVideo:async(e,n,r,d)=>{i.admob.reward.isPending=!0;const a=await i.admob.showRewardVideo(e,n,r,d);return i.admob.reward.isPending=!1,a}}},inapp:{init:async e=>{try{if(!window.store)throw new Error("Store plugin not found");return new Promise((n,r)=>{window.store.ready(()=>{try{e.forEach(d=>{window.store.register({id:d.id,type:d.type})}),window.store.refresh(),n()}catch(d){r(d)}})})}catch(n){throw console.error("스토어 초기화 실패:",n),n}},purchase:async e=>{try{return window.store?new Promise(n=>{const r=a=>{a.finish(),n(!0)},d=()=>{n(!1)};window.store.when(e).approved(r),window.store.when(e).rejected(d),window.store.when(e).cancelled(d),window.store.order(e)}):!1}catch(n){return console.error("상품 구매 실패:",n),!1}},restore:async()=>{try{return window.store?new Promise(e=>{const n=r=>{r&&r.state==="approved"&&r.finish()};window.store.when("*").approved(n),window.store.when("*").owned(n),window.store.refresh(),setTimeout(()=>e(!0),3e3)}):!1}catch(e){return console.error("구매 복원 실패:",e),!1}},getProduct:e=>{try{return window.store?window.store.get(e):null}catch(n){return console.error("상품 정보 가져오기 실패:",n),null}}},PRODUCT_TYPES:{get CONSUMABLE(){var e;return((e=window.store)==null?void 0:e.CONSUMABLE)||"consumable"},get NON_CONSUMABLE(){var e;return((e=window.store)==null?void 0:e.NON_CONSUMABLE)||"non-consumable"},get SUBSCRIPTION(){var e;return((e=window.store)==null?void 0:e.PAID_SUBSCRIPTION)||"paid subscription"}}};export{i as U};
