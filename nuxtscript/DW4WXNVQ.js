import{_ as C}from"./BsPMWsse.js";import{d as O,i as j,u as I,j as U,k as D,e as l,l as F,m as L,b as P,r as E,f as M,p as $,q as H,o as q,x as G,y as V,w as W,v as z,g as i,a as t,h as _,t as J,C as K,B as Q}from"./cyCOdGck.js";import{u as X}from"./BEOqkvGu.js";import"./sRUYLMiV.js";import"./D2ZKPdBb.js";const Y={class:"flex flex-col items-center justify-center my-6"},Z={class:"py-4 px-8 rounded-lg border-2 border-gray-600 mb-2"},ee={for:"name",class:"block mt-2 text-sm font-medium text-gray-400 text-center"},te={class:"rounded-lg text-center border-2 border-gray-200 p-1 mb-4 flex flex-col justify-center items-center"},ie=O({__name:"confirmation",setup(se){const{$client:p}=j(),{TOAST_INFO_TIMEOUT:oe,TOAST_WARNING_TIMEOUT:h,TOAST_ERROR_TIMEOUT:w}=I().public.CONSTANTS,{show:g,hide:S}=U(),v=D(),b=X(),c=l(),a=l(),n=l(),x=l(!0),T=F(),m=L(),y=P(),u=E({email:"",name:""}),r=l(),f=T.query.email,R=s=>{if(n.value=s.target.files[0],!n.value)return;if(n.value.type!=="image/jpeg"&&n.value.type!=="image/jpg"&&n.value.type!=="image/png"&&n.value.type!=="image/PNG"){n.value=void 0,y.warning("이미지 파일을 넣어주세요",{timeout:h});return}const e=s.target.files;if(FileReader&&e&&e.length){const o=new FileReader;o.onload=function(){a.value=o.result},o.readAsDataURL(e[0])}},k=()=>{c.value&&(c.value.value=""),a.value=""},N=async()=>{var s;if(a.value&&n.value){v.show({msg:"프로필 사진을 적용 중..."});const e=a.value,o=((s=a.value)==null?void 0:s.name)??"",d=await p.user.update.mutate({email:f,picture:e,pictureName:o});v.hide(),d||y.error("인터넷이 불안정하니 새로고침하거나 다시 시도해주세요",{timeout:w})}},A=async()=>{await N(),await b.show(u.email,"/")},B=async()=>{await m.push("/")};return M(async()=>{var s,e;if(!f){g({msg:"인터넷이 불안정하거나 조건이 맞지 않아요. 이메일 입력 페이지로 다시 돌아가요",onHide:()=>{m.push({path:"/auth/email"})}});return}if(r.value=await p.user.getUser.mutate({email:f}),u.email=((s=r.value)==null?void 0:s.email)??"",u.name=((e=r.value)==null?void 0:e.name)??"",r.value){x.value=!1;return}g({msg:"인터넷이 불안정하거나 조건이 맞지 않아요. 이메일 입력 페이지로 다시 돌아가요",onHide:()=>{m.push({path:"/auth/email"})}})}),$((s,e,o)=>{b.beforeRouteLeave(s,e,o)}),H(async()=>{S()}),(s,e)=>{const o=C,d=Q;return q(),G(d,{name:"auth",step:"confirmation"},{default:V(()=>[W(t("div",null,[t("div",Y,[e[0]||(e[0]=t("div",{class:"mb-1"},"프로필 카드",-1)),t("div",Z,[_(o,{class:"mx-auto",state:"custom",src:i(a)},null,8,["src"]),t("label",ee,J(i(u).name),1)])]),t("div",te,[e[1]||(e[1]=t("label",{for:"title",class:"block mb-2 text-sm font-medium text-white"}," 프로필 이미지 설정 ",-1)),t("input",{ref_key:"$profile",ref:c,type:"file",class:"mb-2",onChange:R},null,544),t("button",{class:"block text-center bg-blue-600 rounded-lg py-1 px-3 hover:bg-blue-800",onClick:k}," 이미지 초기화 ")]),e[3]||(e[3]=t("div",{class:"text-center mb-8"},[t("p",null,"위 내용대로 계정이 생성됐어요"),t("p",null,"프로필 사진을 정해주거나 넘어가세요"),t("p",null,"나중에 다시 설정할 수 있어요")],-1)),t("button",{class:"mb-2 w-full text-white bg-red-600 hover:bg-red-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center",onClick:A}," 로그인하러 가기 "),t("button",{class:"w-full text-white bg-blue-600 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center flex justify-center items-center",onClick:B},[e[2]||(e[2]=t("p",null,"Home으로 가기",-1)),_(i(K),{class:"h-6 w-6 text-white ml-2"})])],512),[[z,!i(x)]])]),_:1})}}});export{ie as default};
