import"./B5Qt9EMX.js";const h={ads:!1,level:1},T=a=>new Promise(t=>setTimeout(t,a));let I,o,r,x,_,w,v=!0;class N extends Phaser.Scene{constructor(){super({key:"game_play"})}create(){_=this.cameras.main,E(this),L(this)}}let y=0;function L(a){let t=720+_.scaleManager.canvasBounds.x;I=a.cache.json.get("lv3"),o=[],r=[];let l,i,g=115,c,e,d,b,f,H=!0,k=I.levels[h.level].map.length;b=Math.ceil(k/2),b<4&&(b=4),k<5?i=700:i=400,f=1.2,b==6&&(f=1),b==7&&(f=.9),l=(t-g*b*f)/2+g*f/2-_.scaleManager.canvasBounds.x/2;for(let n=0;n<k;n++){let s;n<b?s=a.add.image(l,i,"tube").setInteractive():(H&&(l=(t-g*(k-b)*f)/2+g*f/2-_.scaleManager.canvasBounds.x/2,H=!1),s=a.add.image(l,950,"tube").setInteractive(),i=o[n-b].y+o[n-b].displayHeight+o[n-b].displayHeight/2,s.y=i),s.setScale(f),s.name=n,o.push(s),l+=s.displayWidth+s.displayWidth/2,s.on("pointerdown",function(p){if(y++,y==1&&(v&&a.sound.play("put"),x=s,d==null&&(d=r[s.name].pop(),c=d.y),P(a,d,d.x,s.y-s.displayHeight/2-d.displayHeight/2-15,1)),y==2)if(x!=s){if(r[s.name].length>3){console.log("a"),y=1;return}let m=r[s.name].pop();if(m!=null)d.name!=m.name?(r[x.name].push(d),d.y=c,x=s,c=m.y,d=m,P(a,d,d.x,s.y-s.displayHeight/2-d.displayHeight,1),y=1):(P(a,d,m.x,s.y-s.displayHeight/2-d.displayHeight,2,m.y-m.displayHeight-3),r[s.name].push(m),r[s.name].push(d),M(a,s),d=null,y=0,x=null);else{let S=s.y+s.displayHeight/2-d.displayWidth/2-15*s.scale;P(a,d,s.x,s.y-s.displayHeight/2-d.displayHeight,2,S),r[s.name].push(d),d=null,y=0,x=null}}else r[s.name].push(d),d.y=c,d=null,y=0,x=null})}for(let n=0;n<o.length;n++){let s=580,p=o[n].displayWidth-40*o[n].scale;s=o[n].y+o[n].displayHeight/2-p/2-15*o[n].scale;let m=[];for(let S=0;S<I.levels[h.level].map[n].values.length;S++){const u=I.levels[h.level].map[n].values[S];switch(o[n].y-55*o[n].scale,u){case 0:e=a.add.image(o[n].x,s,"ball"+u),e.displayWidth=p,e.displayHeight=e.displayWidth,e.name="ball0",m.push(e);break;case 1:e=a.add.image(o[n].x,s,"ball"+u),e.displayWidth=p,e.displayHeight=e.displayWidth,e.name="ball1",m.push(e);break;case 2:e=a.add.image(o[n].x,s,"ball"+u),e.displayWidth=p,e.displayHeight=e.displayWidth,e.name="ball2",m.push(e);break;case 3:e=a.add.image(o[n].x,s,"ball"+u),e.displayWidth=p,e.displayHeight=e.displayWidth,e.name="ball3",m.push(e);break;case 4:e=a.add.image(o[n].x,s,"ball"+u),e.displayWidth=p,e.displayHeight=e.displayWidth,e.name="ball4",m.push(e);break;case 5:e=a.add.image(o[n].x,s,"ball"+u),e.displayWidth=p,e.displayHeight=e.displayWidth,e.name="ball5",m.push(e);break;case 6:e=a.add.image(o[n].x,s,"ball"+u),e.displayWidth=p,e.displayHeight=e.displayWidth,e.name="ball6",m.push(e);break;case 7:e=a.add.image(o[n].x,s,"ball"+u),e.displayWidth=p,e.displayHeight=e.displayWidth,e.name="ball7",m.push(e);break;case 8:e=a.add.image(o[n].x,s,"ball"+u),e.displayWidth=p,e.displayHeight=e.displayWidth,e.name="ball8",m.push(e);break;case 9:e=a.add.image(o[n].x,s,"ball"+u),e.displayWidth=p,e.displayHeight=e.displayWidth,e.name="ball9",m.push(e);break;case 10:e=a.add.image(o[n].x,s,"ball"+u),e.displayWidth=p,e.displayHeight=e.displayWidth,e.name="ball10",m.push(e);break}s-=e.displayWidth+3}r.push(m)}}async function M(a,t){if(r[t.name].length<4)return!1;for(let l=0;l<r[t.name].length;l++)if(r[t.name][l],r[t.name][l].name!=r[t.name][0].name)return!1;t.removeInteractive(),v&&a.sound.play("correct"),await T(200);for(let l=0;l<r[t.name].length;l++){const i=r[t.name][l];U(a,i)}return C(a),!0}async function C(a){for(let l=0;l<o.length;l++){const i=o[l];for(let g=0;g<r[i.name].length;g++)if(r[i.name][g].name!=r[i.name][0].name||r[i.name].length>0&&r[i.name].length!=4)return!1}await T(600),h.level++;let t=JSON.parse(localStorage.getItem("data_game"));return h.level>t.level&&(t.level=h.level,localStorage.setItem("data_game",JSON.stringify(t))),a.scene.launch("game_next_lv"),!0}function P(a,t,l,i,g,c){v&&a.sound.play("drop");let e=i,d=a.tweens;switch(g){case 1:d.add({targets:t,x:{from:t.x,to:l},y:{from:t.y,to:e},ease:"Linear",duration:5,repeat:0});break;case 2:e=c,d.add({targets:t,x:{from:t.x,to:l},y:{from:t.y,to:e},ease:"Linear",duration:70});break}}function E(a){F(a);let t=a.add.bitmapText(360,65,"rafale","LEVEL "+h.level).setOrigin(.5);t.tint="0xffffff",t.fontSize=35}function F(a){console.log(_.scaleManager.canvasBounds.x),a.add.image(360,640,"bg1").setScale(.4,.6),a.add.image(360,65,"btnCenter").setScale(.5);let t=a.add.image(70,65,"btnMenu").setScale(.4).setInteractive();t.on("pointerdown",function(i){window.UtilPlatform.sendMsg2Parent("ShowNavFooterPlay"),O(a,t,"btnMenu")});let l=a.add.image(t.x+80,t.y,"btnReload").setScale(.4).setInteractive();l.on("pointerdown",function(i){O(a,l,"btnReload")}),w=a.add.image(670,l.y,"btnSoundOn").setScale(.4).setInteractive(),w.on("pointerdown",function(i){O(a,w,"btnSoundOn")})}function U(a,t){a.add.particles(0,0,t.name,{x:t.x,y:t.y,speed:{min:-600,max:600},angle:{min:0,max:360},scale:{start:.1,end:0},blendMode:"SCREEN",frequency:5,lifespan:600,gravityY:800,quantity:3,maxParticles:15})}function z(a){switch(a){case"btnReload":this.scene.restart("game_play");break;case"btnVideo":break;case"btnMenu":this.scene.launch("game_menu");break;case"btnSoundOn":v?(w.setTexture("btnSoundOff"),v=!1):(w.setTexture("btnSoundOn"),v=!0);break}}function O(a,t,l){a.tweens.add({targets:t,scale:{from:t.scale-.15,to:t.scale},ease:"Bounce",duration:500,onComplete:z.bind(a,l)})}class R extends Phaser.Scene{constructor(){super({key:"preload",pack:{files:[{type:"image",key:"thumb",url:"thumb_1.png"}]}})}preload(){var t=this.add.graphics();this.add.graphics();var l=720,i=1280,g=this.make.text({x:l/2,y:i/2-30,text:"Loading...",style:{font:"50px monospace",fill:"#ffffff"}});g.setOrigin(.5,.5);var c=this.make.text({x:l/2,y:i/2+25,text:"0%",style:{font:"20px monospace",fill:"#000000"}});c.setOrigin(.5,.5),this.load.on("progress",function(e){c.setText(parseInt(e*100)+"%"),t.clear(),t.fillStyle(65280,1),t.fillRect(206,1280/2+8,300*e,30)}),this.load.on("complete",function(){}),this.load.image("block","assets/images/block.png"),this.load.image("tube","assets/images/tube.png"),this.load.image("top","assets/images/top.png"),this.load.image("light","assets/images/light.png"),this.load.image("rule","assets/images/rule.png"),this.load.image("ball0","assets/images/ball/ball1.png"),this.load.image("ball1","assets/images/ball/ball2.png"),this.load.image("ball2","assets/images/ball/ball3.png"),this.load.image("ball3","assets/images/ball/ball4.png"),this.load.image("ball4","assets/images/ball/ball5.png"),this.load.image("ball5","assets/images/ball/ball6.png"),this.load.image("ball6","assets/images/ball/ball7.png"),this.load.image("ball7","assets/images/ball/ball8.png"),this.load.image("ball8","assets/images/ball/ball9.png"),this.load.image("ball9","assets/images/ball/ball10.png"),this.load.image("ball10","assets/images/ball/ball11.png"),this.load.json("data_game","assets/data/data.json"),this.load.json("lv1","assets/data/level/1.json"),this.load.json("lv2","assets/data/level/2.json"),this.load.json("lv3","assets/data/level/3.json"),this.load.image("bg1","assets/images/bg/9.png"),this.load.image("btnMenu","assets/images/button/btnMenu.png"),this.load.image("btnReload","assets/images/button/btnReload.png"),this.load.image("btnBack","assets/images/button/btnBack.png"),this.load.image("btnSoundOn","assets/images/button/btnSoundOn.png"),this.load.image("btnSoundOff","assets/images/button/btnSoundOff.png"),this.load.image("btnCenter","assets/images/button/NameBack.png"),this.load.image("btnLv","assets/images/button/lv.png"),this.load.image("btnLv_lock","assets/images/button/lv_lock.png"),this.load.bitmapFont("popin","assets/fonts/popin.png","assets/fonts/popin.xml"),this.load.bitmapFont("rafale","assets/fonts/rafale.png","assets/fonts/rafale.xml"),this.load.audio("drop","assets/audio/drop.mp3"),this.load.audio("put","assets/audio/put.mp3"),this.load.audio("correct","assets/audio/correct.wav")}create(){localStorage.getItem("rule")==null?(localStorage.setItem("rule",0),this.scene.start("tutorial")):(localStorage.getItem("data_game")==null?(this.data_game=this.cache.json.get("data_game"),localStorage.setItem("data_game",JSON.stringify(this.data_game))):this.data_game=JSON.parse(localStorage.getItem("data_game")),h.level=this.data_game.level,this.scene.start("game_play"))}}let W;class j extends Phaser.Scene{constructor(){super({key:"game_menu"})}preload(){this.load.scenePlugin("rexuiplugin","https://raw.githubusercontent.com/rexrainbow/phaser3-rex-notes/master/dist/rexuiplugin.min.js","rexUI","rexUI")}create(){window.UtilPlatform.sendMsg2Parent("ShowNavFooterPlay"),localStorage.getItem("data_game")==null?(this.data_game=this.cache.json.get("data_game"),localStorage.setItem("data_game",JSON.stringify(this.data_game))):this.data_game=JSON.parse(localStorage.getItem("data_game")),h.level=this.data_game.level,W=this.cameras.main,720+W.scaleManager.canvasBounds.x,J(this);var t=this.rexUI.add.scrollablePanel({x:this.game.config.width/2,y:this.game.config.height/2,width:200,height:1050,scrollMode:0,panel:{child:A(this),mask:{mask:!0,padding:1}},space:{left:10,right:10,top:10,bottom:10,panel:10}}).layout();t.setChildrenInteractive({targets:[t.getByName("level",!0)]}).on("child.click",function(l){l.name>h.level||(h.level=l.name,B(this.scene,l,"selectChild"))})}}function J(a){a.add.image(360,640,"bg1"),a.add.rectangle(360,40,720,80,"0x6b5142",.9);let t=a.add.bitmapText(360,40,"rafale","SELECT LEVEL").setOrigin(.5);t.tint="0xffffff",t.fontSize=35;let l=a.add.image(60,40,"btnBack").setScale(.4).setInteractive();l.on("pointerdown",function(i){window.UtilPlatform.sendMsg2Parent("HideNavFooterPlay"),B(a,l,"btnBack")})}function A(a){for(var t=a.rexUI.add.gridSizer({column:5,row:3,space:{column:10,row:10},name:"level"}),l=1;l<101;l++)t.add(G(a,l));return t}var G=function(a,t){var l=a.add.image(0,100,"btnLv").setScale(1);t<=h.level?l.setTexture("btnLv"):l.setTexture("btnLv_lock");let i=a.add.bitmapText(0,0,"rafale",t,30).setOrigin(.5);t<=h.level?i.setFontSize(30):i.setFontSize(0);var g=a.rexUI.add.sizer({orientation:"y",width:100,height:110,space:{item:20},name:t}).addBackground(l).add(i,{align:"center",padding:{left:0,right:0,top:25,bottom:0}});return g};function B(a,t,l){a.tweens.add({targets:t,scale:{from:t.scale-.15,to:t.scale},ease:"Bounce",duration:500,onComplete:$.bind(a,l)})}function $(a){switch(a){case"btnBack":this.scene.start("game_play");break;case"selectChild":this.scene.start("game_play");break}}class V extends Phaser.Scene{constructor(){super({key:"game_next_lv"})}create(){this.add.rectangle(360,640,720,1280,"0x000000",.8);let t=this.add.image(360,500,"light").setScale(.9);t.alpha=.9;let l=this.add.image(t.x,t.y,"top").setScale(1.6),i=this.add.bitmapText(l.x,l.y-20,"rafale","LEVEL COMPLETE",40).setOrigin(.5);i.tint="0x00000";let g=this.add.image(0,0,"block").setScale(.9,.4);g.tint="0xFFB319";let c=this.add.bitmapText(g.x,g.y,"rafale","NEXT",40).setOrigin(.5);i.tint="0x00000";let e=this.add.container(360,800);e.add(g),e.add(c),e.setSize(g.width,g.height),e.setInteractive(),e.on("pointerdown",function(d){X(this.scene,e,"btnNext")}),this.tweens.add({targets:e,scaleX:{from:0,to:1},scaleY:{from:0,to:1},ease:"Bounce",duration:800})}}function q(a){switch(a){case"btnNext":this.scene.start("game_play");break}}function X(a,t,l){a.tweens.add({targets:t,scale:{from:t.scale-.25,to:t.scale},ease:"Bounce",duration:500,onComplete:q.bind(a,l)})}class Y extends Phaser.Scene{constructor(){super({key:"tutorial"})}create(){this.add.image(360,640,"bg1").setScale(.4,.6),this.add.image(360,640,"rule");let t=this.add.image(360,1020,"btnCenter").setScale(.7).setInteractive(),l=this.add.bitmapText(360,1020,"rafale","PLay").setOrigin(.5);l.tint="0xffffff",l.fontSize=35,t.on("pointerdown",function(i){localStorage.getItem("data_game")==null?(this.data_game=this.scene.cache.json.get("data_game"),localStorage.setItem("data_game",JSON.stringify(this.data_game))):this.data_game=JSON.parse(localStorage.getItem("data_game")),h.level=this.data_game.level,this.scene.scene.start("game_play")})}}window.onload=function(){let a={type:Phaser.AUTO,scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH,parent:"game",width:720,height:1280},scene:[R,N,j,V,Y]};new Phaser.Game(a)};
